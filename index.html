<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
		div.btnContainer {
			display: inline-block;
			position: relative;
			/* text-align: center; */
		}

		p {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			color: white;
			user-select: none;
			text-align: center;
			font-size: 30px;
			margin: 0px;
		}

	</style>
</head>

<body>
	<div id="buttons">
	</div>
</body>
<script>
	(function () {

		const buttonCanvas = [];
		const buttonPushed = [];
		const buttonsDiv = document.getElementById("buttons");
		const images = [];
		function imagePreLoad() {
			for (let i = 0; i < 15; i++) {
				const imageOffOn = [];
				for (let j = 0; j < 2; j++) {
					imageOffOn[j] = new Image();
					const pushed = (j === 0) ? "off" : "on";
					const img = `Buttons-main/btn${i + 1}${pushed}.png`;
					imageOffOn[j].src = img;
				}
				images.push(imageOffOn);
			}

		}
		function buttonInit() {
			for (let i = 0; i < 15; i++) {
				const btnDiv = document.createElement("div");
				const newCanvas = document.createElement("canvas");
				btnDiv.className = "btnContainer";
				btnDiv.appendChild(newCanvas);

				const newText = document.createElement("p");
				newText.textContent = "ボタン";
				btnDiv.appendChild(newText);
				buttonsDiv.appendChild(btnDiv);
				buttonCanvas.push(newCanvas);
				buttonPushed.push(false);


			}
		}
		function createMiddleBtn(num, pushed) {
			const newCanvas = buttonCanvas[num];
			const ctx = newCanvas.getContext('2d');
			const imageW = images[num][pushed].width;
			const imageH = images[num][pushed].height;
			newCanvas.width = 400;
			newCanvas.height = 120;
			const x = newCanvas.width / 2 - imageW / 2;
			const y = newCanvas.height / 2 - imageH / 2;
			ctx.drawImage(images[num][pushed], x, y, imageW, imageH);
		}
		function dispButtons() {
			buttonCanvases = document.getElementsByTagName("canvas");
			for (let i = 0; i < buttonCanvases.length; i++) {
				const pushed = (buttonPushed[i] !== true) ? 0 : 1;
				images[i][pushed].onload = function () {
					createMiddleBtn(i, pushed);
				}
			}
		}

		function click() {
			buttonCanvases = document.getElementsByTagName("canvas");

			for (let i = 0; i < 15; i++) {
				window.addEventListener('mouseup', function () {
					if (buttonPushed[i] === true) {
						buttonPushed[i] = false;
						const pushed = (buttonPushed[i] !== true) ? 0 : 1;
						createMiddleBtn(i, pushed);
					}
				});
				window.addEventListener('touchend', function () {
					if (buttonPushed[i] === true) {
						buttonPushed[i] = false;
						const pushed = (buttonPushed[i] !== true) ? 0 : 1;
						createMiddleBtn(i, pushed);
					}
				});
				buttonCanvases[i].addEventListener('mousedown', function () {
					buttonPushed[i] = true;
					const pushed = (buttonPushed[i] !== true) ? 0 : 1;
					createMiddleBtn(i, pushed);
				});
				buttonCanvases[i].addEventListener('touchstart', function () {
					buttonPushed[i] = true;
					const pushed = (buttonPushed[i] !== true) ? 0 : 1;
					createMiddleBtn(i, pushed);
				});

			}
		}
		imagePreLoad()
		buttonInit();
		dispButtons();
		click();
	})();
</script>

</html>
